let ids=priv.ids;function getRecords(){return priv.permissions.slice(0).map((e=>Object.fromEntries([["table",e.table],["name",e.name],["index",e.index],["allowed",e.allowed],...ids.map((t=>[t,e.permission&priv[t]]))])))}function getFormatter(e){return function(t,a){let i=t.getRow(),l=i.getIndex(),n=e+"_"+l,s=priv[e],r=i.getData().allowed,o=t.getValue()==s;return i.checked=o,'<div class="form-check"><input type="checkbox" class="form-check-input ew-priv ew-multi-select" name="'+n+'" id="'+n+'" value="'+s+'" data-index="'+l+'"'+(o?" checked":"")+((r&s)!=s?" disabled":"")+"></div>"}}function displayTableName(e,t){let a=e.getRow();return`<span data-bs-toggle="tooltip" data-bs-title="${ew.htmlEncode(a.getData().name)}">${a.getData().table}</span><input type="hidden" name="table_${a.getIndex()}" value="1">`}function getTitleHtml(e,t){return'<div class="form-check"><input type="checkbox" class="form-check-input ew-priv" name="'+e+'" id="'+e+'" data-ew-action="select-all"><label class="form-check-label" for="'+e+'">'+ew.language.phrase("Permission"+(t||e))+"</label></div>"}function getColumns(){return[{title:'<span class="fw-normal">'+ew.language.phrase("Tables")+"</span>",field:"table",formatter:displayTableName,sorter:"string",headerSortTristate:headerSortTristate,resizable:!1},...ids.map((e=>({title:getTitleHtml(e),field:e,formatter:getFormatter(e),headerSort:!1,resizable:!1})))]}(e=>{let t,a=ew.deepAssign({index:"index",data:getRecords(),layout:"fitDataFill",initialSort:[{column:"table",dir:"asc"}],columnHeaderSortMulti:!1,columns:getColumns()},tableOptions),i=new Tabulator(".ew-card.ew-user-priv .ew-card-body",a);i.on("dataProcessed",(()=>{e("input[type=checkbox]").on("change",(function(){let t=parseInt(this.dataset.index,10),a=parseInt(this.value,10);isNaN(t)||isNaN(a)||(this.checked?priv.permissions[t].permission|=a:priv.permissions[t].permission^=priv.permissions[t].permission^a,this.name.startsWith("admin_")&&e(this).closest("div[role=row]").find(`input.ew-priv[type=checkbox][data-index=${t}]`).not(this).not(":disabled").prop("checked",this.checked).each(((t,a)=>e(a).triggerHandler("change"))))}));let t=document.querySelector("main");e("span[data-bs-toggle=tooltip][data-bs-title]").tooltip({container:t,offset:[0,4]}),ew.initMultiSelectCheckboxes(),ew.fixLayoutHeight()})),e("#table-name").on("input",(()=>{t?.cancel(),t=e.later(200,null,(()=>i.setFilter("table","like",e("#table-name").val())))}))})(jQuery);
//# sourceMappingURL=userpriv.min.js.map